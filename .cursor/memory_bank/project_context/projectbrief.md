# 프로젝트 개요 (Project Brief)

## 1. 프로젝트명

Lexical 기반 차세대 ERP 렌더링 엔진 구축

## 2. 핵심 목표

기존 5.0 프레임워크의 UI 렌더링 시스템을 `Lexical` 프레임워크 기반의 새로운 렌더링 파이프라인으로 전면 대체하는 것을 목표로 합니다.

- **성능 목표**: **5000행 x 50열 규모의 그리드를 0.3초 이내에 렌더링**할 수 있는 고성능을 달성합니다.

## 3. 범위 (Scope)

- **기능 확장**: `Lexical`을 단순 텍스트 에디터를 넘어, ERP 시스템의 모든 UI 컴포넌트(입력 필드, 그리드, 폼 등)를 렌더링할 수 있는 범용 렌더링 엔진으로 확장합니다.
- **파이프라인 구축**: ERP의 전체 UI를 처리할 수 있는 포괄적인 렌더링 파이프라인을 개발합니다.
- **개발자 경험**: 새로운 렌더링 엔진이 개발자들에게 뛰어난 성능, 안정성, 확장성을 제공하도록 보장합니다.

## 4. 주요 대상

- 이 새로운 렌더링 엔진을 사용하여 차세대 ERP 시스템을 구축하고 유지보수할 사내 개발팀.

## 5. 기반 기술: Lexical의 핵심 설계 철학

이 프로젝트는 Lexical을 단순한 텍스트 에디터가 아닌, 확장 가능한 **UI 렌더링 프레임워크**로 활용합니다. Lexical의 핵심 설계 사상은 다음과 같으며, 이는 우리가 목표하는 범용 렌더링 엔진 구축에 매우 부합합니다.

-   **프레임워크로서의 역할**: Lexical은 모든 기능이 내장된 완성품(monolithic)이 아니라, React처럼 핵심 엔진만 제공하고 개발자가 필요한 기능을 직접 만들어 올릴 수 있는 구조입니다. 이는 ERP의 다양한 커스텀 컴포넌트를 구현하는 데 높은 유연성을 제공합니다.

-   **EditorState와 불변성(Immutability)**: Lexical의 모든 데이터 모델의 중심에는 `EditorState`가 있습니다.
    -   `EditorState`는 **노드 트리(Node Tree)** 와 **선택(Selection)** 객체로 구성됩니다.
    -   생성된 `EditorState`는 **불변(immutable)** 입니다. 상태를 수정하기 위해서는 반드시 `editor.update()`를 통해 새로운 상태를 생성해야 합니다. 이 불변성은 상태 변화를 예측 가능하게 하고, 실행 취소(undo/redo)와 같은 기능을 효율적으로 구현하는 기반이 됩니다.

-   **더블 버퍼링 (Double-Buffering)**: 데이터 일관성을 위해 더블 버퍼링 기술을 사용합니다.
    -   **"current" 상태**: 현재 화면에 보이는 상태입니다.
    -   **"pending" 상태**: `editor.update()` 스코프 내에서 다음에 적용될 상태입니다.
    -   업데이트가 완료되면 "pending" 상태가 새로운 "current" 상태로 스왑(swap)됩니다.

-   **자체 DOM 조정자 (DOM Reconciler)**: Lexical은 가상 DOM(Virtual DOM)과 유사한 자체 DOM 조정자를 내장하고 있습니다.
    -   "current" 상태와 "pending" 상태를 비교(diff)하여, 변경이 필요한 최소한의 부분만 실제 DOM에 업데이트합니다.
    -   이를 통해 DOM 조작을 최소화하고, LTR/RTL 언어 지원 등 복잡한 엣지 케이스를 안정적으로 처리하며 높은 성능을 보장합니다.

-   **렉시컬 스코프와 `$` 접두사**: `$`로 시작하는 함수들(e.g., `$getRoot()`)은 `editor.update()`나 `editor.read()`와 같이 활성화된 `EditorState` 컨텍스트, 즉 '렉시컬 스코프' 내에서만 호출되어야 합니다. 이는 React Hooks와 유사한 규칙으로, 런타임에 상태 접근의 유효성을 보장하는 중요한 제약 조건입니다. 