# Failure Management Protocol (실패 관리 프로토콜)
# version: 1.0

## Description
이 프로토콜은 시스템이 `FAILED` 상태에 진입했을 때, 실패 상황을 체계적으로 기록하고 해결 과정을 문서화하여 시스템의 안정성과 회복탄력성을 높이는 것을 목표로 합니다.

---

## Steps (실행 단계)

### **Part 1: 실패 기록 (Incident Logging)**

#### **Step 1.1: 실패 보고서 초안 생성**
- **Trigger:** 시스템이 `FAILED` 상태에 진입하면 자동으로 실행됩니다.
- **Action:**
    1.  현재 시간(`YYYY-MM-DD_HH-mm-ss`)을 기반으로 파일명을 생성합니다. (e.g., `2025-08-05_14-30-00_failure_report.md`)
    2.  `failure_reports` 디렉토리에 아래 정의된 **'실패 보고서 스키마'**에 따라 마크다운 파일을 생성합니다.
    3.  보고서의 `상태` 필드를 `[조사중]`으로 설정합니다.
    4.  실패 직전의 `activeContext.md` 내용 전체를 `초기 컨텍스트 스냅샷` 섹션에 기록합니다.
- **Rationale:** 문제 발생 시점의 모든 컨텍스트를 신속하게 확보하여 정확한 원인 분석의 기반을 마련합니다.

#### **Step 1.2: 사용자에게 상황 보고**
- **Action:** 생성된 실패 보고서의 경로와 함께 현재 상황을 사용자에게 알리고, 해결을 위한 다음 지시를 대기합니다.
- **Rationale:** 시스템의 투명성을 확보하고, 문제 해결의 주도권을 사용자에게 전달합니다.

---

## Part 2: 해결 및 회고 (Resolution & Post-mortem)

#### **Step 2.1: 해결 과정 기록**
- **Trigger:** 사용자가 실패 상황에 대한 해결책이나 다음 단계를 지시했을 때 실행됩니다.
- **Action:**
    1.  가장 최근에 생성된 실패 보고서 파일을 `read_file`로 읽어옵니다.
    2.  사용자의 지시 내용을 바탕으로 `해결 과정 및 결과` 섹션을 상세히 작성합니다.
    3.  보고서의 `상태` 필드를 `[해결됨]`으로 변경하여 파일을 업데이트합니다.
- **Rationale:** 단순한 문제 해결을 넘어, 실패로부터 학습하고 미래에 동일한 문제가 반복되는 것을 방지하기 위한 지식 자산을 축적합니다.

#### **Step 2.2: 시스템 상태 복귀**
- **Action:**
    1.  실패 보고서 업데이트가 완료되었음을 사용자에게 보고합니다.
    2.  `brain.yaml`에 정의된 상태 전이 규칙에 따라, `PLANNING` 상태로 복귀하여 사용자가 지시한 해결책을 수행할 준비를 합니다.
- **Rationale:** 모든 기록 절차를 마친 후에야 시스템이 정상 작업 흐름으로 돌아가도록 하여, 프로세스의 무결성을 보장합니다.

---

## Schema: 실패 보고서 (Failure Report)

```markdown
# 실패 보고서 (Failure Report)

- **생성 시각**: `YYYY-MM-DD HH:mm:ss`
- **상태**: `[조사중]` 또는 `[해결됨]`

---

## 1. 오류 요약 (Error Summary)

(어떤 작업을 수행하던 중 어떤 오류가 발생했는지 1~2 문장으로 요약)

---

## 2. 초기 컨텍스트 스냅샷 (Initial Context Snapshot)

\`\`\`markdown
(실패 직전의 activeContext.md 파일 내용 전체를 여기에 복사)
\`\`\`

---

## 3. 해결 과정 및 결과 (Resolution & Outcome)

(사용자의 지시에 따라 문제를 해결한 과정을 상세히 기록. 어떤 조치를 취했고, 그 결과 시스템이 어떻게 정상화되었는지 서술)
```
